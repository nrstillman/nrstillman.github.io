<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Publications</title>
    <script src="js/bibtexParse.js"></script>
</head>

<body>
<div class="container main">
    <h2>Recent Publications</h2>
    <div id="bibliography"></div>
</div>

<!-- <script>
fetch('publications.bib')
  .then(response => {
    if (!response.ok) {
      throw new Error("Error fetching .bib file");
    }
    return response.text();
  })
  .then(bibtex => {
    console.log("Raw BibTeX content:", bibtex);
    var parsed = bibtexParse.toJSON(bibtex);
    console.log("Parsed content:", parsed);


    var output = "";
    parsed.forEach(entry => {
      var title = entry.entryTags.title;
      var author = entry.entryTags.author;
      var journal = entry.entryTags.journal;
      var year = entry.entryTags.year;
      var volume = entry.entryTags.volume || "";
      var number = entry.entryTags.number || "";
      var pages = entry.entryTags.pages || "";
      var doi = entry.entryTags.doi || "";
      var url = entry.entryTags.url || "";

      var apaCitation = author + ". (" + year + "). " + title + ". " + journal + ", " + volume + "(" + number + "), " + pages + ". " + (doi ? "DOI: " + doi : "") + "<br>";

      output += "<li><a href='" + url + "'>" + apaCitation + "</a></li>";
    });


    document.getElementById("bibliography").innerHTML = "<ul>" + output + "</ul>";
  })
  .catch(error => console.error("An error occurred:", error));
</script>
 -->
<script>
  function formatBibtex(json) {
    var out = '';
    for (var i in json) {
      out += "@" + json[i].entryType + "{";
      if (json[i].citationKey)
        out += json[i].citationKey + ",\n";
      if (json[i].entryTags) {
        var tags = '';
        for (var jdx in json[i].entryTags) {
          tags += "  " + jdx + " = {" + json[i].entryTags[jdx] + "},\n";
        }
        out += tags;
      }
      out += "}\n\n";
    }
    return out;
  }
fetch('publications.bib')
  .then(response => {
    if (!response.ok) {
      throw new Error("Error fetching .bib file");
    }
    return response.text();
  })
  .then(bibtex => {
    console.log("Raw BibTeX content:", bibtex);
    var parsed = bibtexParse.toJSON(bibtex);
    console.log("Parsed content:", parsed);


    var output = "";
    parsed.forEach(entry => {

    var bibtexJson = bibtexParse.toJSON(inputBibtex); // assuming inputBibtex contains your BibTeX data
    var formattedBibtex = formatBibtex(bibtexJson);

  // Now you can insert the formattedBibtex string into your HTML, e.g.:
  document.getElementById('bibtexContainer').textContent = formattedBibtex;
</script>

</body>
</html>
